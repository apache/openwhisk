def dockerImageName = 'swiftaction'
def dockerRegistry =  project.hasProperty('dockerRegistry') ? dockerRegistry + '/' : ''
def dockerImageTag = project.hasProperty('dockerImageTag') ? dockerImageTag : 'latest'

task distDocker(type:Exec) {
    commandLine 'docker', 'build', '-t', dockerRegistry + 'whisk/' + dockerImageName + ':' + dockerImageTag, '.'
}
task pushImage(type:Exec) {
    commandLine 'docker', 'push', dockerRegistry + 'whisk/' + dockerImageName + ':' + dockerImageTag
}
pushImage.onlyIf { dockerRegistry != '' }
distDocker.finalizedBy pushImage